
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Example lecture: A “zero-dimensional” energy balance model of Earth’s climate &#8212; Lecture University of Bremen</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '01_energy';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to the Course: Climate of the Earth System" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/zmt_logo.png" class="logo__image only-light" alt="Lecture University of Bremen - Home"/>
    <img src="_static/zmt_logo.png" class="logo__image only-dark pst-js-only" alt="Lecture University of Bremen - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the Course: Climate of the Earth System
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Example lecture: A “zero-dimensional” energy balance model of Earth’s climate</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/florianboergel/lectureBremen" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/florianboergel/lectureBremen/issues/new?title=Issue%20on%20page%20%2F01_energy.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/01_energy.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Example lecture: A “zero-dimensional” energy balance model of Earth’s climate</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-observed-global-energy-budget">The Observed Global Energy Budget</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-does-the-global-energy-budget-matter">Why does the Global Energy Budget matter?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#absorbed-solar-radiation">1.1 Absorbed solar radiation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outgoing-longwave-radiation">1.2 Outgoing Longwave Radiation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#human-caused-greenhouse-effect">1.3 Human-caused greenhouse effect</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observations-from-mauna-loa-volcano">Observations from Mauna Loa Volcano</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-in-heat-content">1.4 Change in Heat Content</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-dimensional-climate-model-equation">1.5 “Zero-Dimensional” Climate Model Equation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-method-and-data-structures">2) Numerical solution method and data structures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretization">2.1) Discretization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timestepping">2.2) Timestepping</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-simulations-of-the-energy-balance-model">2.4) Running simulations of the energy balance model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-balance-model-applications">3) Energy balance model applications</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-was-earth-s-preindustrial-climate-so-stable">3.1) Why was Earth’s preindustrial climate so stable?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#historical-global-warming-fueled-by-greenhouse-gas-emissions">3.2) Historical global warming fueled by greenhouse gas emissions</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="example-lecture-a-zero-dimensional-energy-balance-model-of-earth-s-climate">
<h1>Example lecture: A “zero-dimensional” energy balance model of Earth’s climate<a class="headerlink" href="#example-lecture-a-zero-dimensional-energy-balance-model-of-earth-s-climate" title="Link to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This lecture requires</p>
<ul class="simple">
<li><p><strong>Programming knowledge</strong>: Basic to intermediate Python programming skills</p></li>
<li><p><strong>Mathematical background</strong>: Basic calculus (e.g. Taylor series), numerics (Euler time stepping) and differential equations (ODE)</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="the-observed-global-energy-budget">
<h2>The Observed Global Energy Budget<a class="headerlink" href="#the-observed-global-energy-budget" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reminder
The global energy budget is the balance of energy coming into and going out of Earth. An imbalance in the global energy budget leads to a change in the heat content of the climate system.</p>
</div>
<section id="why-does-the-global-energy-budget-matter">
<h3>Why does the Global Energy Budget matter?<a class="headerlink" href="#why-does-the-global-energy-budget-matter" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>Climate Change Connection</strong>: Changes in Earth’s energy budget directly drive global warming and alter weather patterns. Higher greenhouse gas concentrations trap more energy, resulting in planetary warming.</p></li>
<li><p><strong>Real-world Consequences</strong>:</p>
<aside class="margin sidebar">
<p class="sidebar-title">Quick Fact</p>
<p>Energy imbalances are responsible for unpredictable climate events.</p>
</aside>
<ul class="simple">
<li><p><strong>Extreme Weather</strong>: More frequent and intense hurricanes, floods, droughts, and extreme precipitation.</p></li>
<li><p><strong>Polar Ice Loss</strong>: The warming accelerates ice sheet melting, raising sea levels and disrupting critical ocean circulation systems</p></li>
<li><p><strong>Biodiversity Risk</strong>: Warmer regions put numerous species’ habitats in danger.</p></li>
</ul>
</li>
<li><p><strong>Human Influence</strong>: Our activities—like burning fossil fuel and deforestation—significantly alter the energy budget by increasing atmospheric greenhouse gases and raising global temperatures. Understanding these energy dynamics helps us assess our environmental impact and develop sustainable alternatives.</p></li>
</ul>
<figure class="align-default" id="energy-budget">
<a class="reference internal image-reference" href="https://brian-rose.github.io/ClimateLaboratoryBook/_images/GlobalEnergyBudget.png"><img alt="https://brian-rose.github.io/ClimateLaboratoryBook/_images/GlobalEnergyBudget.png" src="https://brian-rose.github.io/ClimateLaboratoryBook/_images/GlobalEnergyBudget.png" style="height: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">The global <strong>annual mean</strong> energy fluxes.</span><a class="headerlink" href="#energy-budget" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In this lecture, we’ll build a basic climate model based on this energy budget. But first, we need a <strong>simpler</strong> version of this budget.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Climate Model Basics</p>
<p>Our simple climate model can be written as:</p>
<ul class="simple">
<li><p><strong>Heat Content Change</strong> =</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(+\)</span> Absorbed solar radiation</p></li>
<li><p><span class="math notranslate nohighlight">\(-\)</span> Outgoing Longwave Radiation</p></li>
<li><p><span class="math notranslate nohighlight">\(+\)</span> Human-caused greenhouse effect</p></li>
</ul>
</li>
</ul>
<p>These elements represent a global average, hence the term “zero-dimensional.”</p>
</div>
<figure class="align-default" id="energy-balance">
<a class="reference internal image-reference" href="_images/ebm.png"><img alt="_images/ebm.png" src="_images/ebm.png" style="height: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Planetary Energy Balance</span><a class="headerlink" href="#energy-balance" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>How to build the model?
To make this simple conceptual model quantitative, we need a mathematical formulation for each of these three processes.</p>
</div>
</section>
<section id="absorbed-solar-radiation">
<h3>1.1 Absorbed solar radiation<a class="headerlink" href="#absorbed-solar-radiation" title="Link to this heading">#</a></h3>
<p>At Earth’s orbital distance from the Sun, the power of the Sun’s rays that intercept the Earth is equal to</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="mi">1368</span> <span class="c1"># solar insolation [W/m^2]  (energy per unit time per unit area)</span>
</pre></div>
</div>
</div>
</div>
<p>A small fraction</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># albedo, or planetary reflectivity [unitless]</span>
</pre></div>
</div>
</div>
</div>
<p>of this incoming solar radiation is reflected back out to space (by reflective surfaces like white clouds, snow, and ice), with the remaining fraction <span class="math notranslate nohighlight">\((1-\alpha)\)</span> being absorbed.</p>
<p>Since the incoming solar rays are all approximately parallel this far from the Sun, the cross-sectional area of the Earth that intercepts them is just a disc of area <span class="math notranslate nohighlight">\(\pi R^{2}\)</span>. Since all of the other terms we will consider act on the entire surface area <span class="math notranslate nohighlight">\(4\pi R^{2}\)</span> of the spherical Earth, the absorbed solar radiation <em>per unit surface area</em> (averaged over the entire globe) is reduced by a factor of 4.</p>
<figure class="align-default" id="energy-solar-radiation">
<a class="reference internal image-reference" href="_images/earth-solar-radiation-diagram.png"><img alt="_images/earth-solar-radiation-diagram.png" src="_images/earth-solar-radiation-diagram.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Earth Solar Radiation</span><a class="headerlink" href="#energy-solar-radiation" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The absorbed solar radiation per unit area is thus</p>
<div class="math notranslate nohighlight">
\[\text{absorbed solar radiation} \equiv \frac{S(1-\alpha)}{4}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">absorbed_solar_radiation</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="mi">1368</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">S</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Heat Content Change</strong> =</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(+\)</span> Absorbed solar radiation ✅</p></li>
<li><p><span class="math notranslate nohighlight">\(-\)</span> Outgoing Longwave Radiation</p></li>
<li><p><span class="math notranslate nohighlight">\(+\)</span> Human-caused greenhouse effect</p></li>
</ul>
</li>
</ul>
</section>
<section id="outgoing-longwave-radiation">
<h3>1.2 Outgoing Longwave Radiation<a class="headerlink" href="#outgoing-longwave-radiation" title="Link to this heading">#</a></h3>
<p>Assume that the Earth acts similarly to a blackbody radiator. If we consider the Earth’s effective global mean emission temperature as <span class="math notranslate nohighlight">\(T_e\)</span> then the relation is given by:</p>
<div class="math notranslate nohighlight">
\[OLR = \sigma T_e^4\]</div>
<p>In the above equation:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(OLR\)</span> stands for Outgoing Longwave Radiation</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span> represents the Stefan-Boltzmann constant and has a value of <span class="math notranslate nohighlight">\(5.67\times 10^{-8} W m^{-2}K^{-4}\)</span></p></li>
</ul>
<p>From observational data, the average global annual value for <span class="math notranslate nohighlight">\(OLR\)</span> is 238.5 W <span class="math notranslate nohighlight">\(m^{-2}\)</span>.</p>
<p>Given this value, we can rearrange the equation to find <span class="math notranslate nohighlight">\(T_e\)</span>:</p>
<div class="math notranslate nohighlight">
\[T_e = \left(\frac{OLR}{\sigma}\right)^{0.25}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">OLR</span> <span class="o">=</span> <span class="mf">238.5</span>  <span class="c1"># W/m²</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">5.67e-8</span>  <span class="c1"># W/m²/K⁴</span>

<span class="c1"># Calculate Te using the Stefan-Boltzmann law</span>
<span class="n">Te</span> <span class="o">=</span> <span class="p">(</span><span class="n">OLR</span><span class="o">/</span><span class="n">sigma</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Earth&#39;s Emission temperature (Te): </span><span class="si">{</span><span class="n">Te</span><span class="o">-</span><span class="mf">273.15</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> °C&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Earth&#39;s Emission temperature (Te): -18.48 °C
</pre></div>
</div>
</div>
</div>
<p>The outgoing longwave radiation, denoted as <span class="math notranslate nohighlight">\(G(T)\)</span>, represents the combined effects of negative feedbacks that <strong>dampen warming</strong>, such as <strong>blackbody radiation</strong>, and positive feedbacks that <strong>amplify warming</strong>, such as <strong>clouds</strong> that trap heat.</p>
<p>Since these physics are too complex to address in full detail here, we linearize the model by approximating the relationship between temperature and radiation.</p>
<p>We begin with the assumption that the preindustrial climate existed in energy balance, meaning the equilibrium temperature equals the preindustrial temperature <span class="math notranslate nohighlight">\(T_0\)</span>.</p>
<p>This allows us to simplify our approach by using just the first-order term of a Taylor series expansion:</p>
<div class="math notranslate nohighlight">
\[G(T) \approx G(T_0) + G^{'}(T_0) (T-T_0)\]</div>
<p>around the pre-industrial equilibrium temperature <span class="math notranslate nohighlight">\(T_0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T0</span> <span class="o">=</span> <span class="mf">14.</span> <span class="c1"># preindustrial temperature averaged over the entire planet [°C]</span>
</pre></div>
</div>
</div>
</div>
<p>By expanding:</p>
<div class="math notranslate nohighlight">
\[ G(T) \approx G(T_0) + G'(T_0)T - G'(T_0)T_0 \]</div>
<p>To simplify the expression, we define:</p>
<div class="math notranslate nohighlight">
\[ A \equiv G(T_0) - G^{'}(T_0)T_0 \]</div>
<div class="math notranslate nohighlight">
\[B \equiv - G^{'}(T_0) \text{       (the climate feedback parameter),}\]</div>
<p>which gives</p>
<div class="math notranslate nohighlight">
\[ \text{Outgoing Longwave Radiation} \equiv G(T) \approx A - BT\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">outgoing_longwave_radiation</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><span class="math notranslate nohighlight">\(B\)</span> comes from a bottom-up estimate based on the best understanding of the various climate feedbacks (read more <a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2019rg000678">here</a>)</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.3</span> <span class="c1"># climate feedback parameter [W/m^2/°C],</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since <span class="math notranslate nohighlight">\(B&lt;0\)</span>, this tells us that the overall climate feedback is negative (i.e., stabilizing).</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Assumption:
The value of <span class="math notranslate nohighlight">\(A\)</span> is determined by the preindustrial equilibrium condition, which states that before human influence, Earth’s energy budget was balanced:</p>
<div class="math notranslate nohighlight">
\[\frac{S(1-\alpha)}{4} = A - BT_0\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{S(1-\alpha)}{4}\)</span> represents the absorbed solar radiation</p></li>
<li><p><span class="math notranslate nohighlight">\(A - BT_0\)</span> is the OLR during the preindustrial equilibrium</p></li>
</ul>
</div>
<p>By rearanging this equation, we find that the value of <span class="math notranslate nohighlight">\(A\)</span> is given by</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">absorbed_solar_radiation</span><span class="p">()</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">T0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="c1"># W/m^2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>221.2
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Heat Content Change</strong> =</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(+\)</span> Absorbed solar radiation ✅</p></li>
<li><p><span class="math notranslate nohighlight">\(-\)</span> Outgoing Longwave Radiation ✅</p></li>
<li><p><span class="math notranslate nohighlight">\(+\)</span> Human-caused greenhouse effect</p></li>
</ul>
</li>
</ul>
</section>
<section id="human-caused-greenhouse-effect">
<h3>1.3 Human-caused greenhouse effect<a class="headerlink" href="#human-caused-greenhouse-effect" title="Link to this heading">#</a></h3>
<p>The greenhouse effect from carbon dioxide has been empirically determined to follow a logarithmic relationship with atmospheric CO₂ concentrations:</p>
<div class="math notranslate nohighlight">
\[\text{Human-caused greenhouse effect} = a \cdot \ln\left(\frac{CO_2}{CO_{2,PI}}\right)\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a\)</span> is a constant representing climate sensitivity to <span class="math notranslate nohighlight">\(CO_2\)</span> changes</p></li>
<li><p><span class="math notranslate nohighlight">\(CO_2\)</span> is the current atmospheric carbon dioxide concentration</p></li>
<li><p><span class="math notranslate nohighlight">\(CO_{2,PI}\)</span> is the preindustrial carbon dioxide concentration</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># CO2 forcing coefficient [W/m^2]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CO2_PI</span> <span class="o">=</span> <span class="mi">280</span> <span class="c1"># preindustrial CO2 concentration [parts per million; ppm];</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">greenhouse_effect</span><span class="p">(</span><span class="n">CO2</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">CO2_PI</span><span class="o">=</span><span class="mi">280</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CO2</span><span class="o">/</span><span class="n">CO2_PI</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_present</span> <span class="o">=</span> <span class="mi">420</span>
<span class="n">co2_range</span> <span class="o">=</span> <span class="mi">280</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">co2_range</span><span class="p">,</span> <span class="n">greenhouse_effect</span><span class="p">(</span><span class="n">co2_range</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Radiative forcing [$W/m^2$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$CO_2$ concentration [ppm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CO2_PI</span><span class="p">,</span> <span class="n">greenhouse_effect</span><span class="p">(</span><span class="n">CO2_PI</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;pre-industrial (PI)&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">co2_present</span><span class="p">,</span> <span class="n">greenhouse_effect</span><span class="p">(</span><span class="n">co2_present</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;present day (2020)&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">280</span><span class="p">,</span> <span class="mi">280</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">280</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="mi">280</span><span class="o">*</span><span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f3eec4eafc0822059859dfcd92bdb162070af445cf3083d2838aac1c0da08f92.png" src="_images/f3eec4eafc0822059859dfcd92bdb162070af445cf3083d2838aac1c0da08f92.png" />
</div>
</div>
<ul class="simple">
<li><p><strong>Heat Content Change</strong> =</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(+\)</span> Absorbed solar radiation ✅</p></li>
<li><p><span class="math notranslate nohighlight">\(-\)</span> Outgoing Longwave Radiation ✅</p></li>
<li><p><span class="math notranslate nohighlight">\(+\)</span> Human-caused greenhouse effect ✅</p></li>
</ul>
</li>
</ul>
</section>
<section id="observations-from-mauna-loa-volcano">
<h3>Observations from Mauna Loa Volcano<a class="headerlink" href="#observations-from-mauna-loa-volcano" title="Link to this heading">#</a></h3>
<figure class="align-default" id="volcano-mauna-loa">
<a class="reference internal image-reference" href="https://i.pinimg.com/originals/df/1a/e7/df1ae72cfd5e6d0d535c0ec99e708f6f.jpg"><img alt="https://i.pinimg.com/originals/df/1a/e7/df1ae72cfd5e6d0d535c0ec99e708f6f.jpg" src="https://i.pinimg.com/originals/df/1a/e7/df1ae72cfd5e6d0d535c0ec99e708f6f.jpg" style="height: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Mauna Loa Volcano</span><a class="headerlink" href="#volcano-mauna-loa" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="change-in-heat-content">
<h3>1.4 Change in Heat Content<a class="headerlink" href="#change-in-heat-content" title="Link to this heading">#</a></h3>
<p>The heat content of the climate system is determined by the temperature <span class="math notranslate nohighlight">\(T\)</span> (in Kelvin) and the system’s heat capacity. We can express this relationship as:</p>
<div class="math notranslate nohighlight">
\[C_{temp} = c_p \cdot T\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C_{temp}\)</span> represents the total heat content of the climate system</p></li>
<li><p><span class="math notranslate nohighlight">\(c_p\)</span> is the effective heat capacity of the climate system</p></li>
</ul>
<p>The effective heat capacity of the climate system is primarily dominated by the upper ocean’s contribution, which is approximately 51 <span class="math notranslate nohighlight">\(\frac{J}{m^2 K}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="mi">51</span> <span class="c1"># atmosphere and upper-ocean heat capacity [J/m^2/°K]</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Assumption: Constant heat capacity
The rate of change in heat content over time is expressed as</p>
<div class="math notranslate nohighlight">
\[\frac{d(C_{temp})}{dt}.\]</div>
<p>Since the heat capacity of the Earth remains essentially constant, we can simplify this expression in terms of temperature change:</p>
<div class="math notranslate nohighlight">
\[ \frac{d(C_{temp})}{dt} = c_p\frac{dT}{dt} \]</div>
</div>
</section>
<section id="zero-dimensional-climate-model-equation">
<h3>1.5 “Zero-Dimensional” Climate Model Equation<a class="headerlink" href="#zero-dimensional-climate-model-equation" title="Link to this heading">#</a></h3>
<p>Combining all the subcomponent models, we can express the governing equation of our “zero-dimensional” energy balance climate model as an Ordinary Differential Equation (ODE):</p>
<div class="math notranslate nohighlight">
\[ c_p\frac{dT}{dt} = \frac{S(1-\alpha)}{4} - (A - BT) + a \ln\left(\frac{CO_2}{CO_{2,PI}}\right) \]</div>
<p>This equation determines the time evolution of Earth’s globally averaged surface temperature, where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(c_p\frac{dT}{dt}\)</span> represents the rate of heat content change</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{S(1-\alpha)}{4}\)</span> is the absorbed solar radiation</p></li>
<li><p><span class="math notranslate nohighlight">\((A - BT)\)</span> is the outgoing longwave radiation</p></li>
<li><p><span class="math notranslate nohighlight">\(a \ln\left(\frac{CO_2}{CO_{2,PI}}\right)\)</span> accounts for the human-caused greenhouse effect</p></li>
</ul>
</section>
</section>
<section id="numerical-solution-method-and-data-structures">
<h2>2) Numerical solution method and data structures<a class="headerlink" href="#numerical-solution-method-and-data-structures" title="Link to this heading">#</a></h2>
<section id="discretization">
<h3>2.1) Discretization<a class="headerlink" href="#discretization" title="Link to this heading">#</a></h3>
<p>The energy balance model equation above can be discretized in time as</p>
<div class="math notranslate nohighlight">
\[ C\frac{T(t+\Delta t) - T(t)}{\Delta t} = \frac{S (1-\alpha)}{4} - ( A - BT(t)) + a \cdot ln  \frac{CO_2}{CO{_2}_{PI}} \]</div>
<p>This finite difference equation approximates the exact ordinary differential equation through a first-order truncation of the Taylor series expansion.  The approximation becomes more accurate as <span class="math notranslate nohighlight">\(\Delta t\)</span> <span class="math notranslate nohighlight">\(\rightarrow 0\)</span>. In practice, we must select a sufficiently small model timestep <span class="math notranslate nohighlight">\(\Delta t\)</span> to ensure numerical stability and solution convergence while balancing runtime of the model.</p>
<p>Using the notation <span class="math notranslate nohighlight">\(T_n \equiv T(t_n)\)</span> to represent the temperature at timestep <span class="math notranslate nohighlight">\(n\)</span>, and <span class="math notranslate nohighlight">\(T_{n+1} \equiv T(t_{n+1})\)</span> for the temperature at the next timestep <span class="math notranslate nohighlight">\(t_{n+1} = t_n + \Delta t\)</span>, we can rearrange the equation to solve for <span class="math notranslate nohighlight">\(T_{n+1}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ T_{n+1} = T_n + \frac{\Delta t}{C} \left[\frac{S(1-\alpha)}{4} - (A - BT_n) + a \cdot \ln\left(\frac{CO_2}{CO_{2,PI}}\right)\right] \]</div>
</section>
<section id="timestepping">
<h3>2.2) Timestepping<a class="headerlink" href="#timestepping" title="Link to this heading">#</a></h3>
<p>More generally, this equation follows the form of an explicit Euler method:</p>
<div class="math notranslate nohighlight">
\[ T_{n+1} = T_n + \Delta t \cdot \text{tendency}(T_n; \ldots) \]</div>
<p>which we implement below.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Exercise: Calculate the tendency of our Energy Balance Model</p>
<ul class="simple">
<li><p>Current temperature <span class="math notranslate nohighlight">\(T_n\)</span> = 15°C</p></li>
<li><p>Timestep <span class="math notranslate nohighlight">\(\Delta t\)</span> = 1 year</p></li>
</ul>
<p>Determine whether the temperature will increase, decrease, or remain stable in the next timestep.
Explain what this result indicates about Earth’s energy balance at this temperature.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_n</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">deltat</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">tendency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">C</span> <span class="o">*</span> <span class="p">(</span>
    <span class="n">absorbed_solar_radiation</span><span class="p">()</span>
    <span class="o">-</span> <span class="n">outgoing_longwave_radiation</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T_n</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What tendency do you expect?</p>
<p>The tendency is negative because at <span class="math notranslate nohighlight">\(T_n\)</span> = 15°C, the outgoing longwave radiation exceeds the sum of absorbed solar radiation and greenhouse effect. This means the Earth is losing more energy than it’s gaining at this temperature.</p>
</div>
<p>For the next timestep, using the equation <span class="math notranslate nohighlight">\(T_{n+1} = T_n + \Delta t \cdot\)</span> tendency</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_n1</span> <span class="o">=</span> <span class="n">T_n</span> <span class="o">+</span> <span class="n">deltat</span><span class="o">*</span><span class="n">tendency</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_n1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.974509803921569
</pre></div>
</div>
</div>
</div>
<p>Now think about how to calculate the temperature change for the next 150 years? What temperature do you expect after 150 years?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize an array to store temperature values for 150 years</span>
<span class="n">T_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>

<span class="c1"># Set the initial temperature to 15°C</span>
<span class="n">T_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>

<span class="c1"># Loop through each year (1 through 149)</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">150</span><span class="p">):</span>
    <span class="c1"># Calculate the temperature tendency (rate of change) for the current year</span>
    <span class="c1"># tendency = (1/heat_capacity) * (energy_in - energy_out)</span>
    <span class="n">tendency</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">C</span> <span class="o">*</span> <span class="p">(</span>
            <span class="o">+</span> <span class="n">absorbed_solar_radiation</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">S</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">outgoing_longwave_radiation</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">T_n</span><span class="p">[</span><span class="n">year</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="n">B</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">greenhouse_effect</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">CO2_PI</span><span class="o">=</span><span class="n">CO2_PI</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="c1"># Calculate the new temperature using the explicit Euler method:</span>
    <span class="c1"># T(next) = T(current) + (timestep * tendency)</span>
    <span class="n">T_n</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_n</span><span class="p">[</span><span class="n">year</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">deltat</span><span class="o">*</span><span class="n">tendency</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_n</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature [°C]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [years]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Time [years]&#39;)
</pre></div>
</div>
<img alt="_images/60b8afcac81cd2e9440e1a0d4ea7503c4f68e6ef5785acf1096ed92a4a42e477.png" src="_images/60b8afcac81cd2e9440e1a0d4ea7503c4f68e6ef5785acf1096ed92a4a42e477.png" />
</div>
</div>
<p>Now we can finally build our Energy Balance Model (EBM).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">EBM</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Zero Order Energy Balance Model (EBM)</span>

<span class="sd">    The Energy Balance Model (EBM) represents the balance between incoming solar radiation and outgoing longwave radiation.</span>
<span class="sd">    It also considers the greenhouse effect caused by CO2 levels. This model can simulate the temporal evolution of temperature </span>
<span class="sd">    based on various parameters like albedo, solar constant, and greenhouse effect coefficients.</span>

<span class="sd">    Attributes:</span>
<span class="sd">    - T : Temperature (in Kelvin)</span>
<span class="sd">    - t : Time</span>
<span class="sd">    - deltat : Time step</span>
<span class="sd">    - CO2 : Carbon Dioxide function that returns CO2 levels in dependency of time t</span>
<span class="sd">    - C : Heat capacity</span>
<span class="sd">    - a : Greenhouse effect coefficient</span>
<span class="sd">    - A : Outgoing longwave radiation constant</span>
<span class="sd">    - B : Temperature sensitivity of outgoing radiation</span>
<span class="sd">    - CO2_PI : Pre-industrial CO2 concentration</span>
<span class="sd">    - alpha : Albedo</span>
<span class="sd">    - S : Solar constant</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">deltat</span><span class="p">,</span> <span class="n">CO2</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">CO2_PI</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">S</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltat</span> <span class="o">=</span> <span class="n">deltat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">C</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">co2_pi</span> <span class="o">=</span> <span class="n">CO2_PI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="n">S</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">co2</span> <span class="o">=</span> <span class="n">CO2</span>

    <span class="k">def</span> <span class="nf">absorbed_solar_radiation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">S</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">outgoing_longwave_radiation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">A</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">T</span>

    <span class="k">def</span> <span class="nf">greenhouse_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CO2</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">CO2_PI</span> <span class="o">=</span> <span class="mi">280</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CO2</span><span class="o">/</span><span class="n">CO2_PI</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tendency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">current_T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
        <span class="n">current_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">*</span> <span class="p">(</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">absorbed_solar_radiation</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">outgoing_longwave_radiation</span><span class="p">(</span><span class="n">current_T</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">greenhouse_effect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">co2</span><span class="p">(</span><span class="n">current_t</span><span class="p">),</span> <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">CO2_PI</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">co2_pi</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tendency</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tendency</span><span class="p">()</span>
        <span class="n">new_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltat</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltat</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">new_T</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">new_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="running-simulations-of-the-energy-balance-model">
<h3>2.4) Running simulations of the energy balance model<a class="headerlink" href="#running-simulations-of-the-energy-balance-model" title="Link to this heading">#</a></h3>
<p>Let’s define a function that runs an EBM simulation by timestepping forward until a given end_year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">end_year</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">end_year</span><span class="p">):</span>
        <span class="n">model</span><span class="o">.</span><span class="n">timestep</span>
</pre></div>
</div>
</div>
</div>
<p>For example, let us consider the case where CO₂ emissions increase by 1% year-over-year from the preindustrial value [CO<span class="math notranslate nohighlight">\(_2\)</span>] = <span class="math notranslate nohighlight">\(280.0\)</span> ppm, starting at T=T₀=14°C in year t=0 and with a timestep Δt = 1 year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CO2_test</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">CO2_PI</span><span class="o">=</span><span class="mi">280</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">CO2_PI</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">**</span><span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;T&quot;</span><span class="p">:</span><span class="n">T0</span><span class="p">,</span>
    <span class="s2">&quot;t&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;deltat&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;CO2&quot;</span><span class="p">:</span><span class="n">CO2_test</span><span class="p">,</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span><span class="n">C</span><span class="p">,</span>
    <span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="n">a</span><span class="p">,</span>
    <span class="s2">&quot;A&quot;</span><span class="p">:</span><span class="n">A</span><span class="p">,</span>
    <span class="s2">&quot;B&quot;</span><span class="p">:</span><span class="n">B</span><span class="p">,</span>
    <span class="s2">&quot;CO2_PI&quot;</span><span class="p">:</span><span class="mi">280</span><span class="p">,</span>
    <span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="n">alpha</span><span class="p">,</span>
    <span class="s2">&quot;S&quot;</span><span class="p">:</span><span class="n">S</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Python, the ** syntax in a function call is used for unpacking key-value pairs from dictionaries directly into function arguments. This is particularly useful when working with functions that accept a variable number of keyword arguments.</p>
<p>In summary, ** in a function call is used to unpack dictionary items as keyword arguments.</p>
</div>
</section>
</section>
<section id="energy-balance-model-applications">
<h2>3) Energy balance model applications<a class="headerlink" href="#energy-balance-model-applications" title="Link to this heading">#</a></h2>
<section id="why-was-earth-s-preindustrial-climate-so-stable">
<h3>3.1) Why was Earth’s preindustrial climate so stable?<a class="headerlink" href="#why-was-earth-s-preindustrial-climate-so-stable" title="Link to this heading">#</a></h3>
<p>Let us consider the simple case where CO₂ concentrations remain at their pre-industrial temperatures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CO2_test</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">280</span>

<span class="n">model_parameters</span><span class="p">[</span><span class="s2">&quot;CO2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CO2_test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">EBM</span><span class="p">(</span><span class="o">**</span><span class="n">model_parameters</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">run_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t0s</span><span class="p">:</span>
    <span class="n">model_parameters</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">EBM</span><span class="p">(</span><span class="o">**</span><span class="n">model_parameters</span><span class="p">)</span>
    <span class="n">run_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;temperature [°C]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;temperature [°C]&#39;)
</pre></div>
</div>
<img alt="_images/8c4e73392b07eb4fc7a72660f99efd4debfd8044f72cbeb6cdc3f8e799376ebb.png" src="_images/8c4e73392b07eb4fc7a72660f99efd4debfd8044f72cbeb6cdc3f8e799376ebb.png" />
</div>
</div>
<p>This figure shows that, no matter where we start out, the overall negative feedbacks (<span class="math notranslate nohighlight">\(B&lt;0\)</span>) restore the temperature to the preindustrial equilibrum value of <span class="math notranslate nohighlight">\(T_0\)</span> = 14.0 °C, over an exponential timescale of about 100 years.</p>
</section>
<section id="historical-global-warming-fueled-by-greenhouse-gas-emissions">
<h3>3.2) Historical global warming fueled by greenhouse gas emissions<a class="headerlink" href="#historical-global-warming-fueled-by-greenhouse-gas-emissions" title="Link to this heading">#</a></h3>
<p>Human greenhouse gas emissions have fundamentally altered Earth’s energy balance, moving us away from the stable preindustrial climate of the past few thousand years.</p>
<p>Since human CO₂ emissions are the main driver of global warming, we expect that if we plug historical CO₂ increases into our model (“forcing” it), we should roughly reproduce the observed historical global warming.</p>
<p>The observed increase of CO2 concentrations can be fairly accurately modelled by the simple cubic formula below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">co2_hist</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">280</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="p">((</span><span class="n">t</span><span class="o">-</span><span class="mi">1850</span><span class="p">)</span><span class="o">/</span><span class="mi">220</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_parameters</span><span class="p">[</span><span class="s2">&quot;CO2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">co2_hist</span>
<span class="n">model_parameters</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">T0</span>
<span class="n">model_parameters</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1850</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">EBM</span><span class="p">(</span><span class="o">**</span><span class="n">model_parameters</span><span class="p">)</span>

<span class="n">run_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mi">170</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/florianboergel/climateoftheocean/main/data/graph.txt&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">temp_url</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">skiprows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">on_bad_lines</span><span class="o">=</span><span class="s1">&#39;skip&#39;</span><span class="p">,</span>  <span class="c1"># Skip problematic lines</span>
                      <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">+</span> <span class="mf">14.15</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading temperature data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">CO2_url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/florianboergel/climateoftheocean/main/data/monthly_in_situ_co2_mlo.csv&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">co2_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">CO2_url</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">58</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading CO2 data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">co2_data</span> <span class="o">=</span> <span class="n">co2_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span> 
<span class="n">co2_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">co2_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">5</span><span class="p">])</span> 
<span class="n">co2_data</span><span class="p">[</span><span class="n">co2_data</span><span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">co2_data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">co2_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>
<span class="n">co2_data</span> <span class="o">=</span> <span class="n">co2_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">co2_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">bx</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2020</span><span class="p">),</span> <span class="n">co2_hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2020</span><span class="p">)),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;EBM model&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">co2_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">co2_data</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Keeling Curve&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$CO_2$ concentration [ppm]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">bx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2021</span><span class="p">),</span> <span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;EBM model&quot;</span><span class="p">)</span>
<span class="n">temp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">bx</span><span class="p">)</span>
<span class="n">bx</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature [°C]&quot;</span><span class="p">)</span>
<span class="n">bx</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">bx</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;EBM Model&quot;</span><span class="p">,</span> <span class="s2">&quot;NASA Observations&quot;</span><span class="p">,</span> <span class="s2">&quot;NASA Obs roll. mean&quot;</span><span class="p">])</span>
<span class="n">bx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>

<span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/61447d76640b827e85e5bafd0ab9b4dfc0676c2958094f04dbb06c3ea13b1d4e.png" src="_images/61447d76640b827e85e5bafd0ab9b4dfc0676c2958094f04dbb06c3ea13b1d4e.png" />
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>CO<sub>2</sub> Emissions: Beyond Trend Predictions to Climate Noise</p>
<p>While CO<sub>2</sub> emissions can be used to predict the overarching trend in climate, we must also consider the inherent climate noise present in observations. This noise doesn’t arise from instrumental inaccuracies but represents genuine signals from the Earth’s natural variability.</p>
<p>Such natural fluctuations are mainly attributed to the turbulent and chaotic fluid dynamics of both the atmosphere and the ocean. We will delve deeper into this topic in <strong>Lecture 4</strong>. The dynamics are visually represented in the following illustrations:</p>
</div>
<p><a class="reference download internal" download="" href="_downloads/999039a66fe6881862817e851865cf7c/climate_model.mp4"><span class="xref download myst"><img alt="Video Thumbnail" src="_images/maxresdefault.jpg" /></span></a>{:target=”_blank”}”</p>
<p>Now that we’ve convinced ourselves that the model accurately reproduces historical warming, we can use it to project how much warming we might expect due to future CO₂ emissions.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>What You Learned Today</p>
<ul class="simple">
<li><p><strong>Energy Balance Fundamentals</strong>: Built a zero-dimensional climate model based on absorbed solar radiation, outgoing longwave radiation, and greenhouse effects</p></li>
<li><p><strong>Numerical Climate Modeling</strong>: Implemented and solved differential equations using Python, creating a reusable EBM that reproduces historical temperature trends</p></li>
</ul>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Additional content: Best- and worst-case projections of future global warming</p>
<p>Consider two divergent hypothetical futures:</p>
<ol class="arabic simple">
<li><p>a low-emissions world in which emissions decrease such that CO2 concentrations stay below 500 ppm by 2100 (known in climate circles as “RCP2.6”) and</p></li>
<li><p>a high-emissions world in which emissions continue increasing and CO2 concentrations soar upwards of 1200 ppm (“RCP8.5”).</p></li>
</ol>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CO2_RCP26</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">280</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="p">((</span><span class="n">t</span><span class="o">-</span><span class="mi">1850</span><span class="p">)</span><span class="o">/</span><span class="mi">220</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">t</span><span class="o">-</span><span class="mi">1850</span><span class="p">)</span><span class="o">-</span><span class="mi">170</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">)))</span>
<span class="k">def</span> <span class="nf">CO2_RCP85</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">280</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="p">((</span><span class="n">t</span><span class="o">-</span><span class="mi">1850</span><span class="p">)</span><span class="o">/</span><span class="mi">220</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(((</span><span class="n">t</span><span class="o">-</span><span class="mi">1850</span><span class="p">)</span><span class="o">-</span><span class="mi">170</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>In the low-emissions scenario, the temperature increase stays below <span class="math notranslate nohighlight">\(\Delta T\)</span> = 2 °C by 2100, while in the high-emissions scenario temperatures soar upwards of 3.5ºC above pre-industrial levels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_parameters</span><span class="p">[</span><span class="s2">&quot;CO2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CO2_RCP26</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">EBM</span><span class="p">(</span><span class="o">**</span><span class="n">model_parameters</span><span class="p">)</span>

<span class="n">model_parameters</span><span class="p">[</span><span class="s2">&quot;CO2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CO2_RCP85</span>
<span class="n">model2</span> <span class="o">=</span> <span class="n">EBM</span><span class="p">(</span><span class="o">**</span><span class="n">model_parameters</span><span class="p">)</span>

<span class="n">run_model</span><span class="p">(</span><span class="n">model1</span><span class="p">,</span> <span class="mi">249</span><span class="p">)</span> 
<span class="n">run_model</span><span class="p">(</span><span class="n">model2</span><span class="p">,</span> <span class="mi">249</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">bx</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2100</span><span class="p">),</span> <span class="n">CO2_RCP26</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span><span class="mi">2100</span><span class="p">)),</span> 
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;RCP 2.6 low emissions&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2100</span><span class="p">),</span> <span class="n">CO2_RCP85</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span><span class="mi">2100</span><span class="p">)),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;RCP 8.5 High emissions&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="n">CO2_RCP26</span><span class="p">(</span><span class="mi">2025</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">markersize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;we are here&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$CO_2$ concentration [ppm]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">bx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2100</span><span class="p">),</span> <span class="n">model1</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Blue&quot;</span><span class="p">)</span>
<span class="n">bx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2100</span><span class="p">),</span> <span class="n">model2</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>  <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">)</span>
<span class="n">bx</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Paris Agreement</span><span class="se">\n</span><span class="s2"> threshold (2°C warming)&quot;</span><span class="p">,</span>
           <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">bx</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature [°C]&quot;</span><span class="p">)</span>
<span class="n">bx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2050</span><span class="p">,</span> <span class="n">model2</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">200</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> 
         <span class="n">markersize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;we are here&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">bx</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d78caf72f3aef5afe25e2303c1d6accdc0d486d70ea9b85066660410f4a7d3fc.png" src="_images/d78caf72f3aef5afe25e2303c1d6accdc0d486d70ea9b85066660410f4a7d3fc.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to the Course: Climate of the Earth System</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-observed-global-energy-budget">The Observed Global Energy Budget</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-does-the-global-energy-budget-matter">Why does the Global Energy Budget matter?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#absorbed-solar-radiation">1.1 Absorbed solar radiation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outgoing-longwave-radiation">1.2 Outgoing Longwave Radiation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#human-caused-greenhouse-effect">1.3 Human-caused greenhouse effect</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observations-from-mauna-loa-volcano">Observations from Mauna Loa Volcano</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-in-heat-content">1.4 Change in Heat Content</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-dimensional-climate-model-equation">1.5 “Zero-Dimensional” Climate Model Equation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-method-and-data-structures">2) Numerical solution method and data structures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretization">2.1) Discretization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timestepping">2.2) Timestepping</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-simulations-of-the-energy-balance-model">2.4) Running simulations of the energy balance model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-balance-model-applications">3) Energy balance model applications</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-was-earth-s-preindustrial-climate-so-stable">3.1) Why was Earth’s preindustrial climate so stable?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#historical-global-warming-fueled-by-greenhouse-gas-emissions">3.2) Historical global warming fueled by greenhouse gas emissions</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Florian Börgel
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>